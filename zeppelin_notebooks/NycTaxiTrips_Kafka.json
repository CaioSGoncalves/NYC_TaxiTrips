{"paragraphs":[{"text":"sc","user":"anonymous","dateUpdated":"2020-02-02T20:55:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res3: org.apache.spark.SparkContext = org.apache.spark.SparkContext@695491fe\n"}]},"apps":[],"jobName":"paragraph_1580673522351_-610772268","id":"20200202-195842_453225639","dateCreated":"2020-02-02T19:58:42+0000","dateStarted":"2020-02-02T20:55:35+0000","dateFinished":"2020-02-02T20:55:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:83484"},{"text":"%pyspark\n# READING STREAMING DATA FROM KAFKA\ndf = spark \\\n  .readStream \\\n  .format(\"kafka\") \\\n  .option(\"kafka.bootstrap.servers\", \"10.158.0.57:9092\") \\\n  .option(\"subscribe\", \"nyc_trips\") \\\n  .load()","user":"anonymous","dateUpdated":"2020-02-02T21:04:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580673798974_1975760949","id":"20200202-200318_1369694895","dateCreated":"2020-02-02T20:03:18+0000","dateStarted":"2020-02-02T21:04:15+0000","dateFinished":"2020-02-02T21:04:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83485"},{"text":"%pyspark\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import *\n\n# SETTING SCHEMA AND FORMATTING STREAMING DATA\n\nschema = StructType([ \n                    StructField(\"dropoff_datetime\",StringType(),True),\n                    StructField(\"dropoff_latitude\",DoubleType(),True),\n                    StructField(\"dropoff_longitude\",DoubleType(),True),\n                    StructField(\"fare_amount\",DoubleType(),True),\n                    StructField(\"passenger_count\",LongType(),True),\n                    StructField(\"payment_type\",StringType(),True),\n                    StructField(\"pickup_datetime\",StringType(),True),\n                    StructField(\"pickup_latitude\",DoubleType(),True),\n                    StructField(\"pickup_longitude\",DoubleType(),True),\n                    StructField(\"rate_code\",StringType(),True),\n                    StructField(\"store_and_fwd_flag\",LongType(),True),\n                    StructField(\"surcharge\",DoubleType(),True),\n                    StructField(\"tip_amount\",DoubleType(),True),\n                    StructField(\"tolls_amount\",DoubleType(),True),\n                    StructField(\"total_amount\",DoubleType(),True),\n                    StructField(\"trip_distance\",DoubleType(),True),\n                    StructField(\"vendor_id\",StringType(),True)\n                    ])\n \ndata = df.selectExpr(\"CAST(value AS STRING)\")\\\n        .select(from_json(\"value\", schema).alias(\"data\")).select(\"data.*\")","user":"anonymous","dateUpdated":"2020-02-02T21:02:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580675608220_1949943851","id":"20200202-203328_171143813","dateCreated":"2020-02-02T20:33:28+0000","dateStarted":"2020-02-02T21:02:48+0000","dateFinished":"2020-02-02T21:02:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83486"},{"text":"%pyspark\ndef foreach_batch_function(df, epoch_id):\n    df.write \\\n    .format(\"jdbc\") \\\n    .option(\"driver\", \"com.mysql.jdbc.Driver\") \\\n    .option(\"url\", \"jdbc:mysql://34.95.135.223/nyc_trips\") \\\n    .option(\"dbtable\", \"extra3\") \\\n    .mode(\"append\") \\\n    .option(\"user\", \"root\") \\\n    .option(\"password\", \"12345\") \\\n    .save()\n    \n(data.writeStream.foreachBatch(foreach_batch_function).start())","user":"anonymous","dateUpdated":"2020-02-02T21:31:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.streaming.StreamingQuery object at 0x7f984bbcceb8>\n"}]},"apps":[],"jobName":"paragraph_1580675586139_-1275940007","id":"20200202-203306_325880781","dateCreated":"2020-02-02T20:33:06+0000","dateStarted":"2020-02-02T21:31:27+0000","dateFinished":"2020-02-02T21:31:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83487"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-02-02T21:15:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1580678103223_-58510118","id":"20200202-211503_495544578","dateCreated":"2020-02-02T21:15:03+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:83488"}],"name":"NycTaxiTrips_Kafka","id":"2F1ZCKNBN","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}